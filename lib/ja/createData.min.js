var path=require("path");var fs=require("fs");var jsdom=require("jsdom");var currentDir=path.dirname(process.argv[1]);var pages=require(path.resolve(currentDir+"/sitemap.json"));
var filePath,text,doc;var obj={};var data=[];for(var i=0;i<pages.length;i++){filePath=currentDir+"/../.."+pages[i].path;if(fs.statSync(filePath).isDirectory()){filePath+="index.html";
}absFilePath=path.resolve(filePath);console.log(absFilePath);text=fs.readFileSync(absFilePath,"utf8");doc=jsdom.jsdom(text);if(doc.querySelector(".container article")===null){continue;
}obj={id:pages[i].id,parent:pages[i].parent,title:pages[i].title,breadcrumb:pages[i].breadcrumb,body:doc.querySelector(".container article").innerHTML.replace(/(<([^>]+)>)/ig,"")};
data.push(obj);}fs.writeFile(path.resolve(currentDir+"/pageContents.js"),JSON.stringify(data,null,"    "));